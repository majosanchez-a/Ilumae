<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ilumae ¬∑ Velas artesanales que iluminan tu alma</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#F7B7A3">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --cream:#FAF4EF;--beige:#F2E7DE;--peach:#F7B7A3;--salmon:#F08E80;
      --rose:#D4A5A5;--gold:#C9A769;--graphite:#2A2A2A;--graphite-60:rgba(42,42,42,.6);
      --radius:20px;--shadow:0 10px 40px rgba(0,0,0,.12);--shadow-sm:0 4px 15px rgba(0,0,0,.08);
      --font-display:'Playfair Display',serif;--font-sans:'Poppins',sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth;}
    body{background:var(--cream);color:var(--graphite);font:400 16px/1.6 var(--font-sans);overflow-x:hidden;}
    img{width:100%;display:block;}
    a{text-decoration:none;color:inherit;}
    .container{max-width:1200px;margin:auto;padding:0 24px;}
    
    /* Header mejorado */
    header{
      position: sticky;
      top: 0;
      background: linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.95),
        rgba(250, 244, 239, 0.85),
        rgba(230, 206, 196, 0.75)
      );
      backdrop-filter: blur(12px);
      z-index: 100;
      border-bottom: 1px solid rgba(0,0,0,.08);
      transition: all .3s;
    }

    header.scrolled{box-shadow:var(--shadow-sm);}
    .nav__inner{display:flex;justify-content:space-between;align-items:center;height:80px;}
    .brand{display:flex;align-items:center;gap:0;transition:transform .3s;}
    .brand:hover{transform:scale(1.05);}
    .brand__logo{height:150px;width:auto;object-fit:contain;}
    nav{display:flex;gap:8px;}
    nav a{padding:10px 18px;border-radius:999px;font-weight:500;transition:all .3s;position:relative;}
    nav a:hover{background:var(--beige);transform:translateY(-2px);}
    nav a.active{background:linear-gradient(135deg,var(--peach),var(--salmon));color:#fff;}
    .cart{background:var(--graphite);color:#fff;border:none;cursor:pointer;position:relative;padding:10px 16px;border-radius:999px;transition:all .3s;font-weight:600;}
    .cart:hover{transform:scale(1.1);box-shadow:var(--shadow-sm);}
    .cart__badge{position:absolute;top:-8px;right:-8px;background:var(--salmon);color:#fff;border-radius:999px;padding:4px 8px;font-size:11px;animation:pulse 2s infinite;}
    
    /* Hero mejorado con animaciones */
    .hero{padding:60px 0;position:relative;}
    .hero__wrapper{display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:center;}
    .hero__copy{animation:fadeInUp 1s ease;}
    .display{font:700 clamp(40px,5vw,64px)/1.1 var(--font-display);color:#000;margin-bottom:20px;}
    .lead{color:var(--graphite-60);font-size:19px;margin-bottom:30px;line-height:1.7;}
    .btn{display:inline-block;padding:14px 32px;border-radius:999px;font-weight:600;transition:all .3s;cursor:pointer;position:relative;overflow:hidden;}
    .btn::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.2),transparent);opacity:0;transition:opacity .3s;}
    .btn:hover::before{opacity:1;}
    .btn--primary{background:linear-gradient(135deg,var(--graphite),#1a1a1a);color:#fff;box-shadow:var(--shadow-sm);}
    .btn--primary:hover{transform:translateY(-3px);box-shadow:var(--shadow);}
    .btn--ghost{border:2px solid var(--graphite);margin-left:12px;}
    .btn--ghost:hover{background:var(--graphite);color:#fff;}
    
    /* Carousel mejorado */
    .carousel{position:relative;overflow:hidden;border-radius:var(--radius);box-shadow:var(--shadow);height:500px;}
    .carousel__track{display:flex;height:100%;transition:transform .8s cubic-bezier(0.4, 0, 0.2, 1);}
    .carousel__slide{min-width:100%;height:100%;position:relative;}
    .carousel__slide::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 60%,rgba(0,0,0,.3));}
    .carousel__slide img{object-fit:cover;height:100%;width:100%;border-radius:var(--radius);}
    .carousel__arrow{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.95);border:none;width:50px;height:50px;border-radius:999px;font-size:28px;cursor:pointer;transition:all .3s;z-index:2;display:flex;align-items:center;justify-content:center;}
    .carousel__arrow:hover{background:#fff;transform:translateY(-50%) scale(1.1);}
    .carousel__arrow.left{left:20px;}
    .carousel__arrow.right{right:20px;}
    .carousel__indicators{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:10px;z-index:2;}
    .carousel__dot{width:10px;height:10px;border-radius:999px;background:rgba(255,255,255,.5);cursor:pointer;transition:all .3s;}
    .carousel__dot.active{background:#fff;width:30px;}
    
    /* Secciones */
    section{padding:80px 0;}
    .section__header{text-align:center;margin-bottom:50px;}
    .section__title{font:700 clamp(32px,4vw,48px)/1.2 var(--font-display);margin-bottom:16px;}
    .section__subtitle{color:var(--graphite-60);font-size:18px;max-width:600px;margin:0 auto;}
    
    /* About mejorado */
    .split__inner{display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:center;}
    .split__block{animation:fadeInLeft 1s ease;}
    .split__block h2{font:700 36px var(--font-display);margin-bottom:24px;color:var(--graphite);}
    .split__block p{margin-bottom:20px;line-height:1.8;color:var(--graphite-60);}
    .about__image{border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);position:relative;animation:fadeInRight 1s ease;}
    .about__image::after{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(247,183,163,.2),rgba(240,142,128,.2));mix-blend-mode:multiply;}
    
    /* Productos mejorados */
    .catalog__grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:30px;}
    .product{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow-sm);transition:all .4s;cursor:pointer;overflow:hidden;position:relative;}
    .product:hover{transform:translateY(-10px);box-shadow:var(--shadow);}
    .product__image{position:relative;overflow:hidden;height:300px;}
    .product__image img{height:100%;object-fit:cover;transition:transform .6s;}
    .product:hover .product__image img{transform:scale(1.1);}
    .product__tag{position:absolute;top:15px;right:15px;background:linear-gradient(135deg,var(--peach),var(--salmon));color:#fff;padding:6px 14px;border-radius:999px;font-size:12px;font-weight:600;z-index:1;}
    .product__body{padding:24px;}
    .product__body h3{font:600 22px var(--font-display);margin-bottom:10px;}
    .product__meta{display:flex;justify-content:space-between;align-items:center;margin:12px 0;padding:12px 0;border-top:1px solid var(--beige);border-bottom:1px solid var(--beige);}
    .product__price{font-weight:700;font-size:20px;color:var(--salmon);}
    .product__duration{color:var(--graphite-60);font-size:14px;}
    .product__desc{color:var(--graphite-60);font-size:15px;line-height:1.6;}
    .product__cta{margin-top:16px;width:100%;background:var(--graphite);color:#fff;padding:12px;border:none;border-radius:999px;font-weight:600;cursor:pointer;transition:all .3s;}
    .product__cta:hover{background:var(--salmon);transform:scale(1.05);}
    
    /* Best sellers mejorados */
    .bestseller{position:relative;}
    .bestseller .product__image::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent,rgba(0,0,0,.6));z-index:1;}
    .badge{background:linear-gradient(135deg,var(--gold),#B8935E);color:#fff;padding:8px 16px;border-radius:999px;font-size:13px;font-weight:700;display:inline-block;margin-top:12px;box-shadow:var(--shadow-sm);}
    
    /* Footer mejorado */
    .footer{background:linear-gradient(180deg,var(--beige),var(--peach));padding:40px 0;margin-top:60px;}
    .footer__inner{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px;}
    .footer__block h4{font:600 18px var(--font-display);margin-bottom:16px;}
    .footer__block a{display:block;margin:8px 0;color:var(--graphite-60);transition:all .3s;}
    .footer__block a:hover{color:var(--salmon);transform:translateX(5px);}
    .footer__bottom{text-align:center;padding-top:30px;margin-top:30px;border-top:1px solid rgba(0,0,0,.1);color:var(--graphite-60);}
    
    /* Floating elements */
    .float-msg{position:fixed;bottom:25px;right:25px;background:linear-gradient(135deg,var(--salmon),var(--peach));color:#fff;padding:14px 24px;border-radius:999px;font-size:15px;font-weight:600;box-shadow:var(--shadow);z-index:200;animation:float 3s ease-in-out infinite;}
    .whatsapp-btn{position:fixed;bottom:25px;left:25px;width:60px;height:60px;background:#25D366;border-radius:999px;display:flex;align-items:center;justify-content:center;font-size:32px;box-shadow:var(--shadow);z-index:200;cursor:pointer;transition:all .3s;animation:pulse 2s infinite;}
    .whatsapp-btn:hover{transform:scale(1.1);}

    /* Cart drawer */
    .cart-drawer{position:fixed;right:0;top:0;height:100vh;width:360px;background:#fff;box-shadow:-20px 0 40px rgba(0,0,0,.12);transform:translateX(110%);transition:transform .28s ease;z-index:400;display:flex;flex-direction:column;}
    .cart-drawer.open{transform:translateX(0);}
    .cart-drawer header{padding:20px;border-bottom:1px solid #f2f2f2;display:flex;justify-content:space-between;align-items:center;}
    .cart-items{flex:1;overflow:auto;padding:16px;}
    .cart-item{display:flex;gap:12px;align-items:center;padding:12px 0;border-bottom:1px solid #fafafa;}
    .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px;}
    .cart-item .info{flex:1;}
    .qty-controls{display:flex;gap:8px;align-items:center;}
    .cart-footer{padding:16px;border-top:1px solid #f2f2f2;}
    .btn--checkout{width:100%;background:var(--salmon);color:#fff;padding:12px;border-radius:999px;border:none;font-weight:700;cursor:pointer;}
    
    /* Animaciones */
    @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
    @keyframes fadeInLeft{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}
    @keyframes fadeInRight{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:translateX(0)}}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    
    /* Responsive */
    @media(max-width:768px){
      .hero__wrapper{grid-template-columns:1fr;gap:30px;}
      .hero__copy{text-align:center;}
      .carousel{height:350px;}
      .split__inner{grid-template-columns:1fr;}
      nav{display:none;}
      .catalog__grid{grid-template-columns:1fr;}
    }

    /* ==== POPUP GEN√âRICO (descuento / env√≠o) ==== */
    .popup-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .popup-card {
      background: #FAF4EF;
      border-radius: 20px;
      padding: 24px 28px;
      max-width: 380px;
      width: 90%;
      box-shadow: 0 18px 50px rgba(0,0,0,0.25);
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      position: relative;
    }

    .popup-card h2 {
      font-family: "Playfair Display", serif;
      margin-top: 0;
      margin-bottom: 8px;
    }

    .popup-card p {
      margin: 6px 0 12px;
    }

    .popup-card label {
      display: block;
      font-size: 0.85rem;
      margin-top: 8px;
      margin-bottom: 4px;
    }

    .popup-card input {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #D4A5A5;
      font-size: 0.9rem;
    }

    .popup-card button[type="submit"] {
      margin-top: 14px;
      width: 100%;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      background: #F08E80;
      color: #fff;
    }

    .popup-card button[type="submit"]:hover {
      filter: brightness(1.05);
    }

    .popup-close {
      position: absolute;
      top: 6px;
      right: 8px;
      border: none;
      background: transparent;
      font-size: 1.3rem;
      cursor: pointer;
    }

    .popup-note {
      font-size: 0.8rem;
      color: #555;
      margin-top: 10px;
    }

    /* ==== AUTH SECTION (LOGIN / REGISTRO) ==== */
    #authSection {
      padding: 80px 0;
      background: var(--cream);
    }

    #authSection h2 {
      text-align:center;
      font:700 32px var(--font-display);
      margin-bottom: 8px;
    }

    .auth-forms {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      max-width: 900px;
      margin: 20px auto 0;
    }

    .auth-forms form {
      flex: 1 1 260px;
      background: #F2E7DE;
      padding: 1rem 1.2rem;
      border-radius: 16px;
      box-shadow: var(--shadow-sm);
    }

    .auth-forms h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-family: var(--font-display);
    }

    .auth-forms label {
      display: block;
      font-size: 0.85rem;
      margin-top: 8px;
    }

    .auth-forms input {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #D4A5A5;
      margin-top: 4px;
    }

    .auth-forms button {
      margin-top: 12px;
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #C9A769;
      color: #fff;
      font-weight: 600;
      width: 100%;
    }

    .auth-status {
      max-width: 900px;
      margin: 16px auto 0;
      text-align:center;
    }
  </style>
</head>
<body>
  <header id="header">
    <div class="container nav__inner">
      <a href="#home" class="brand">
        <img src="ILUMAE15.png" alt="Ilumae - Candles & Soaps" class="brand__logo"
             onerror="this.onerror=null;this.src='https://i.ibb.co/BZFp7Yt/ilumae-logo.png';">
      </a>
      <a href="https://www.instagram.com/ilumae_ags?igsh=c2prcjlpOGx1cTQz&utm_source=qr" class="insta-btn" target="_blank" rel="noopener" aria-label="Ir a Instagram">üì∏ @ilumae_ags</a>
      <nav>
        <a href="#home" class="active">Home</a>
        <a href="#about">Nosotras</a>
        <a href="#inventory">Productos</a>
        <a href="#bestsellers">Favoritos</a>
      </nav>
      <button class="cart" aria-label="Ver carrito" onclick="openCart()">üõí<span class="cart__badge" data-cart-count>0</span></button>
    </div>
  </header>

  <main>
    <!-- Hero mejorado -->
    <section id="home" class="hero container">
      <div class="hero__wrapper">
        <div class="hero__copy">
          <h1 class="display">Velas artesanales que iluminan tu alma</h1>
          <p class="lead">Hechas a mano con amor y dedicaci√≥n. Cada vela cuenta una historia de aromas premium, momentos de calma y conexi√≥n con tu espacio interior.</p>
          <a href="#inventory" class="btn btn--primary">Explorar colecci√≥n</a>
          <a href="#about" class="btn btn--ghost">Nuestra historia</a>
        </div>
        <div class="carousel" data-carousel>
          <button class="carousel__arrow left" data-prev>‚Äπ</button>
          <div class="carousel__track" data-track>
            <div class="carousel__slide"><img src="ILUMAE4.jpeg" alt="Velas artesanales"></div>
            <div class="carousel__slide"><img src="ILUMAE6.jpeg" alt="Ambiente acogedor"></div>
            <div class="carousel__slide"><img src="ILUMAE7.jpeg" alt="Velas premium"></div>
          </div>
          <button class="carousel__arrow right" data-next>‚Ä∫</button>
          <div class="carousel__indicators" data-indicators></div>
        </div>
      </div>
    </section>

    <!-- About mejorado -->
    <section id="about">
      <div class="container">
        <div class="section__header">
          <h2 class="section__title">Sobre Nosotras ‚ú®</h2>
          <p class="section__subtitle">Dos amigas, un sue√±o compartido y mucho amor en cada detalle</p>
        </div>
        <div class="split__inner">
          <div class="split__block">
            <h2>Sobre Ilumae</h2>
            <p>Ilumae naci√≥ del amor por los detalles y los momentos que nos invitan a pausar. Somos dos amigas que so√±amos con compartir la calidez de una vela encendida: ese instante donde el aroma transforma el ambiente y nos recuerda respirar.</p>
            <p>Cada vela es hecha a mano, con ingredientes naturales de primera calidad, mechas de algod√≥n puro y fragancias elegidas con intenci√≥n. Creemos que los rituales cotidianos pueden ser bellos y que la luz, el color y el aroma tienen el poder de reconectar.</p>
            <p>Trabajamos con cera de soya sustentable, esencias premium y envases reutilizables porque creemos en crear productos que cuiden de ti y del planeta. ‚ú®</p>
          </div>
          <div class="about__image"><img src="ILUMAE13.jpeg" alt="Taller Ilumae"></div>
        </div>
      </div>
    </section>

    <!-- Inventory mejorado -->
    <section id="inventory">
      <div class="container">
        <div class="section__header">
          <h2 class="section__title">Nuestra colecci√≥n completa</h2>
          <p class="section__subtitle">Descubre aromas √∫nicos creados para cada momento del d√≠a</p>
        </div>
        <div class="catalog__grid">
          <article class="product">
            <div class="product__image">
              <img src="ILUMAE10.jpeg" alt="Citrus Bloom">
              <span class="product__tag">Nuevo</span>
            </div>
            <div class="product__body">
              <h3>Citrus Bloom</h3>
              <div class="product__meta">
                <span class="product__price">$220 MXN</span>
                <span class="product__duration">180 g ¬∑ ~35 h</span>
              </div>
              <p class="product__desc">Notas c√≠tricas brillantes con flores suaves. Perfecta para energizar tu ma√±ana.</p>
              <button class="product__cta" onclick="addToCart('Citrus Bloom', 220)">Agregar al carrito</button>
            </div>
          </article>
          <article class="product">
            <div class="product__image">
              <img src="ILUMAE9.jpeg" alt="Cozy Vanilla">
              <span class="product__tag">Popular</span>
            </div>
            <div class="product__body">
              <h3>Cozy Vanilla</h3>
              <div class="product__meta">
                <span class="product__price">$240 MXN</span>
                <span class="product__duration">220 g ¬∑ ~40 h</span>
              </div>
              <p class="product__desc">Vainilla cremosa con √°mbar y musk. Ideal para espacios acogedores y momentos de lectura.</p>
              <button class="product__cta" onclick="addToCart('Cozy Vanilla', 240)">Agregar al carrito</button>
            </div>
          </article>
          <article class="product">
            <div class="product__image">
              <img src="ILUMAE12.jpeg" alt="Forest Calm">
            </div>
            <div class="product__body">
              <h3>Forest Calm</h3>
              <div class="product__meta">
                <span class="product__price">$260 MXN</span>
                <span class="product__duration">220 g ¬∑ ~40 h</span>
              </div>
              <p class="product__desc">Notas de madera, pino y hierbas suaves. Trae la naturaleza a tu hogar.</p>
              <button class="product__cta" onclick="addToCart('Forest Calm', 260)">Agregar al carrito</button>
            </div>
          </article>
          <article class="product">
            <div class="product__image">
              <img src="ILUMAE11.jpeg" alt="Amber Sunset">
            </div>
            <div class="product__body">
              <h3>Amber Sunset</h3>
              <div class="product__meta">
                <span class="product__price">$250 MXN</span>
                <span class="product__duration">200 g ¬∑ ~38 h</span>
              </div>
              <p class="product__desc">√Åmbar c√°lido con notas dulces de durazno. Ideal para atardeceres m√°gicos.</p>
              <button class="product__cta" onclick="addToCart('Amber Sunset', 250)">Agregar al carrito</button>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Best Sellers mejorado -->
    <section id="bestsellers" style="background:var(--beige);">
      <div class="container">
        <div class="section__header">
          <h2 class="section__title">Las favoritas de nuestra comunidad ‚ú®</h2>
          <p class="section__subtitle">Los aromas que han conquistado m√°s corazones</p>
        </div>
        <div class="catalog__grid">
          <article class="product bestseller">
            <div class="product__image">
              <img src="ILUMAE5.jpeg" alt="Floral Dream">
              <span class="product__tag">üèÜ #1</span>
            </div>
            <div class="product__body">
              <h3>Floral Dream</h3>
              <p class="product__desc">Flores silvestres con miel. Dulce, natural y absolutamente encantadora.</p>
              <span class="badge">Best Seller</span>
            </div>
          </article>
          <article class="product bestseller">
            <div class="product__image">
              <img src="ILUMAE9.jpeg" alt="Cozy Vanilla">
              <span class="product__tag">ü•à #2</span>
            </div>
            <div class="product__body">
              <h3>Cozy Vanilla</h3>
              <p class="product__desc">Vainilla cremosa y notas de √°mbar. Perfecta para tardes de calma y relajaci√≥n.</p>
              <span class="badge">Favorita</span>
            </div>
          </article>
          <article class="product bestseller">
            <div class="product__image">
              <img src="ILUMAE10.jpeg" alt="Citrus Bloom">
              <span class="product__tag">ü•â #3</span>
            </div>
            <div class="product__body">
              <h3>Citrus Bloom</h3>
              <p class="product__desc">Brillante, fresca y floral. Perfecta para acompa√±ar tu energ√≠a del d√≠a.</p>
              <span class="badge">First Choice</span>
            </div>
          </article>
        </div>
      </div>
    </section>
  </main>

  <!-- POPUP DESCUENTO -->
  <div class="popup-overlay" id="discountPopup">
    <div class="popup-card">
      <button class="popup-close" id="closePopupBtn">&times;</button>
      <h2>¬°Bienvenida a ILUMAE! ‚ú®</h2>
      <p>
        Reg√≠strate con tu correo y recibe un 
        <strong>descuento especial en tu primera compra.</strong>
      </p>

      <form id="popupRegisterForm">
        <label for="popupEmail">Correo electr√≥nico</label>
        <input type="email" id="popupEmail" required placeholder="tucorreo@example.com" />

        <label for="popupPassword">Crea una contrase√±a</label>
        <input type="password" id="popupPassword" required placeholder="M√≠nimo 6 caracteres" />

        <button type="submit">Crear cuenta y obtener descuento</button>
      </form>

      <p class="popup-note">
        ¬øYa tienes cuenta? Inicia sesi√≥n en el apartado de Mi cuenta.
      </p>
    </div>
  </div>

  <!-- SECCI√ìN DE LOGIN / REGISTRO NORMAL -->
  <section id="authSection">
    <h2>Mi cuenta</h2>

    <div class="auth-forms">
      <!-- LOGIN -->
      <form id="loginForm">
        <h3>Iniciar sesi√≥n</h3>
        <label for="loginEmail">Correo</label>
        <input type="email" id="loginEmail" required />

        <label for="loginPassword">Contrase√±a</label>
        <input type="password" id="loginPassword" required />

        <button type="submit">Entrar</button>
      </form>

      <!-- REGISTRO -->
      <form id="registerForm">
        <h3>Crear cuenta</h3>
        <label for="registerEmail">Correo</label>
        <input type="email" id="registerEmail" required />

        <label for="registerPassword">Contrase√±a</label>
        <input type="password" id="registerPassword" required />

        <button type="submit">Registrarme</button>
      </form>
    </div>

    <div class="auth-status">
      <p id="authMessage"></p>
      <p id="userInfo" style="display:none;">
        Sesi√≥n iniciada como: <span id="userEmailSpan"></span>
      </p>
      <button id="logoutBtn" style="display:none;">Cerrar sesi√≥n</button>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="footer__inner">
        <div class="footer__block">
          <img src="ILUMAE15.png" alt="Ilumae" style="height: 175px;width:auto;margin-bottom:12px;"
               onerror="this.onerror=null;this.src='https://i.ibb.co/BZFp7Yt/ilumae-logo.png';">
          <p style="color:var(--graphite-60);">Velas artesanales hechas con amor para iluminar tus momentos especiales.</p>
        </div>
        <div class="footer__block">
          <h4>Navegaci√≥n</h4>
          <a href="#home">Home</a>
          <a href="#about">Nosotras</a>
          <a href="#inventory">Productos</a>
          <a href="#bestsellers">Favoritos</a>
        </div>
        <div class="footer__block">
          <h4>Legal</h4>
          <a href="#">T√©rminos y Condiciones</a>
          <a href="#">Pol√≠tica de Privacidad</a>
          <a href="#">Env√≠os y Devoluciones</a>
        </div>
        <div class="footer__block">
          <h4>S√≠guenos</h4>
          <a href="https://www.instagram.com/ilumae_ags?igsh=c2prcjlpOGx1cTQz&utm_source=qr" target="_blank" rel="noopener">Instagram</a>
          <a href="#">Facebook</a>
          <a href="#">TikTok</a>
        </div>
      </div>
      <div class="footer__bottom">
        <p>¬© <span id="year"></span> Ilumae ¬∑ Candles & Soaps ¬∑ De Aguascalientes para el mundo üá≤üáΩ</p>
      </div>
    </div>
  </footer>

  <div class="float-msg">‚ú® Hecho con amor por Ilumae ‚ú®</div>
  <a href="https://wa.me/+14694944165" class="whatsapp-btn" target="_blank" aria-label="WhatsApp">üí¨</a>

  <div id="cartDrawer" class="cart-drawer" aria-hidden="true">
    <header>
      <h3>Tu carrito</h3>
      <button onclick="closeCart()" aria-label="Cerrar carrito">‚úï</button>
    </header>
    <div class="cart-items" id="cartItems">
      <!-- items renderizados aqu√≠ -->
    </div>
    <div class="cart-footer">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <strong>Total</strong><strong id="cartTotal">$0</strong>
      </div>
      <button class="btn--checkout" onclick="checkout()">Pagar</button>
    </div>
  </div>

  <!-- MODAL DATOS DE ENV√çO -->
  <div class="popup-overlay" id="shippingOverlay">
    <div class="popup-card">
      <button class="popup-close" id="closeShippingBtn">&times;</button>
      <h2>Datos de env√≠o üì¶</h2>
      <p>Cu√©ntanos a d√≥nde enviamos tus velitas ‚ú®</p>

      <form id="shippingForm">
        <label for="shipName">Nombre completo</label>
        <input type="text" id="shipName" required placeholder="Nombre y apellido" />

        <label for="shipPhone">Tel√©fono</label>
        <input type="tel" id="shipPhone" required placeholder="10 d√≠gitos" />

        <label for="shipAddress">Calle y n√∫mero</label>
        <input type="text" id="shipAddress" required placeholder="Calle, n√∫mero, colonia" />

        <label for="shipCity">Ciudad y estado</label>
        <input type="text" id="shipCity" required placeholder="Ej. Aguascalientes, Ags." />

        <label for="shipCP">C√≥digo postal</label>
        <input type="text" id="shipCP" required placeholder="CP" />

        <label for="shipNotes">Referencias (opcional)</label>
        <input type="text" id="shipNotes" placeholder="Color de puerta, puntos de referencia, etc." />

        <button type="submit">Confirmar pedido</button>
      </form>
    </div>
  </div>

  <script>
    // --- Carrito: persistente en localStorage ---
    let cart = [];

    function loadCart() {
      try {
        cart = JSON.parse(localStorage.getItem('ilumae_cart')) || [];
      } catch (e) {
        cart = [];
      }
      updateBadge();
      renderCart();
    }

    function saveCart() {
      localStorage.setItem('ilumae_cart', JSON.stringify(cart));
      updateBadge();
      renderCart();
    }

    function updateBadge() {
      const count = cart.reduce((s, i) => s + (i.qty || 0), 0);
      const el = document.querySelector('[data-cart-count]');
      if (el) el.textContent = count;
    }

    function addToCart(name, price, img) {
      const existing = cart.find(i => i.name === name);
      if (existing) {
        existing.qty++;
      } else {
        cart.push({ name, price: Number(price), img: img || '', qty: 1 });
      }
      saveCart();
      openCart();
    }

    function changeQty(name, delta) {
      const item = cart.find(i => i.name === name);
      if (!item) return;
      item.qty += delta;
      if (item.qty <= 0) {
        cart = cart.filter(i => i.name !== name);
      }
      saveCart();
    }

    function removeFromCart(name) {
      cart = cart.filter(i => i.name !== name);
      saveCart();
    }

    function renderCart() {
      const container = document.getElementById('cartItems');
      const totalEl = document.getElementById('cartTotal');
      if (!container || !totalEl) return;

      container.innerHTML = '';
      if (cart.length === 0) {
        container.innerHTML = '<p style="padding:16px;color:var(--graphite-60)">Tu carrito est√° vac√≠o.</p>';
        totalEl.textContent = '$0';
        return;
      }

      cart.forEach(item => {
        const itemEl = document.createElement('div');
        itemEl.className = 'cart-item';
        itemEl.innerHTML = `
          <img src="${item.img || 'https://via.placeholder.com/64'}" alt="${item.name}">
          <div class="info">
            <strong>${item.name}</strong>
            <div style="color:var(--graphite-60);font-size:14px;margin-top:6px;">$${item.price} ¬∑ x${item.qty}</div>
            <div class="qty-controls" style="margin-top:8px;">
              <button onclick="changeQty('${item.name}', -1)">‚àí</button>
              <span style="min-width:28px;text-align:center;display:inline-block">${item.qty}</span>
              <button onclick="changeQty('${item.name}', 1)">+</button>
              <button style="margin-left:12px;color:var(--salmon);background:none;border:none;cursor:pointer" onclick="removeFromCart('${item.name}')">Eliminar</button>
            </div>
          </div>
        `;
        container.appendChild(itemEl);
      });

      const total = cart.reduce((s, i) => s + i.price * i.qty, 0);
      totalEl.textContent = `$${total}`;
    }

    function openCart() {
      const d = document.getElementById('cartDrawer');
      if (!d) return;
      d.classList.add('open');
      d.setAttribute('aria-hidden', 'false');
    }

    function closeCart() {
      const d = document.getElementById('cartDrawer');
      if (!d) return;
      d.classList.remove('open');
      d.setAttribute('aria-hidden', 'true');
    }

    function checkout() {
      if (!cart || cart.length === 0) {
        alert('Tu carrito est√° vac√≠o.');
        return;
      }
      const shippingOverlay = document.getElementById('shippingOverlay');
      if (shippingOverlay) {
        shippingOverlay.style.display = 'flex';
      }
    }

    // A√±o en el footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Header scrolled
    window.addEventListener('scroll', () => {
      document.getElementById('header').classList.toggle('scrolled', window.scrollY > 50);
    });

    // Carousel
    const carousel = document.querySelector('[data-carousel]');
    if (carousel) {
      const track = carousel.querySelector('[data-track]');
      const slides = Array.from(track.children);
      const next = carousel.querySelector('[data-next]');
      const prev = carousel.querySelector('[data-prev]');
      const indicators = carousel.querySelector('[data-indicators]');

      let idx = 0;

      // Create indicators
      slides.forEach((_, i) => {
        const dot = document.createElement('div');
        dot.className = 'carousel__dot' + (i === 0 ? ' active' : '');
        dot.onclick = () => { idx = i; update(); };
        indicators.appendChild(dot);
      });

      const dots = Array.from(indicators.children);

      function update() {
        track.style.transform = `translateX(-${idx * 100}%)`;
        dots.forEach((dot, i) => dot.classList.toggle('active', i === idx));
      }

      next.onclick = () => { idx = (idx + 1) % slides.length; update(); };
      prev.onclick = () => { idx = (idx - 1 + slides.length) % slides.length; update(); };

      // Auto-advance
      setInterval(() => { idx = (idx + 1) % slides.length; update(); }, 5000);

      // Touch support
      let startX = 0;
      track.addEventListener('touchstart', e => startX = e.touches[0].clientX);
      track.addEventListener('touchend', e => {
        const endX = e.changedTouches[0].clientX;
        if (endX - startX > 50) prev.click();
        if (startX - endX > 50) next.click();
      });
    }

    // Active nav
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('nav a');

    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        if (scrollY >= sectionTop - 100) current = section.getAttribute('id');
      });
      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) link.classList.add('active');
      });
    });

    // Cargar carrito al inicio
    loadCart();

    // Registrar Service Worker (para la app)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker
          .register('/service-worker.js')
          .catch(function (err) {
            console.log('Service Worker error:', err);
          });
      });
    }
  </script>

  <!-- üî• LOGIN + POPUP + PEDIDOS CON FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { 
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
    import {
      getFirestore,
      collection,
      addDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBVeMNcoN8TAq7m9VgvD8ng-YUNuQwmJVQ",
      authDomain: "ilumae-82b55.firebaseapp.com",
      projectId: "ilumae-82b55",
      storageBucket: "ilumae-82b55.firebasestorage.app",
      messagingSenderId: "720491821338",
      appId: "1:720491821338:web:330ad22e4088d3da06d4a3",
      measurementId: "G-JS072RSPXV"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    const discountPopup   = document.getElementById('discountPopup');
    const closePopupBtn   = document.getElementById('closePopupBtn');
    const popupRegisterForm = document.getElementById('popupRegisterForm');
    const popupEmail      = document.getElementById('popupEmail');
    const popupPassword   = document.getElementById('popupPassword');

    const loginForm       = document.getElementById('loginForm');
    const registerForm    = document.getElementById('registerForm');
    const loginEmail      = document.getElementById('loginEmail');
    const loginPassword   = document.getElementById('loginPassword');
    const registerEmail   = document.getElementById('registerEmail');
    const registerPassword= document.getElementById('registerPassword');

    const authMessage     = document.getElementById('authMessage');
    const userInfo        = document.getElementById('userInfo');
    const userEmailSpan   = document.getElementById('userEmailSpan');
    const logoutBtn       = document.getElementById('logoutBtn');

    // Elementos del formulario de env√≠o
    const shippingOverlay = document.getElementById('shippingOverlay');
    const closeShippingBtn = document.getElementById('closeShippingBtn');
    const shippingForm    = document.getElementById('shippingForm');

    const shipName   = document.getElementById('shipName');
    const shipPhone  = document.getElementById('shipPhone');
    const shipAddress= document.getElementById('shipAddress');
    const shipCity   = document.getElementById('shipCity');
    const shipCP     = document.getElementById('shipCP');
    const shipNotes  = document.getElementById('shipNotes');

    const DISCOUNT_CODE = "ILUMAE10";

    function maybeShowPopup() {
      const alreadyRegistered = localStorage.getItem('ilumae_registered');
      const popupClosed = localStorage.getItem('ilumae_popup_closed');

      if (!alreadyRegistered && !popupClosed) {
        discountPopup.style.display = 'flex';
      }
    }

    if (closePopupBtn) {
      closePopupBtn.addEventListener('click', () => {
        discountPopup.style.display = 'none';
        localStorage.setItem('ilumae_popup_closed', 'true');
      });
    }

    if (popupRegisterForm) {
      popupRegisterForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = popupEmail.value.trim();
        const password = popupPassword.value.trim();

        try {
          await createUserWithEmailAndPassword(auth, email, password);
          localStorage.setItem('ilumae_registered', 'true');
          discountPopup.style.display = 'none';
          authMessage.textContent = `Cuenta creada. Tu c√≥digo de descuento es: ${DISCOUNT_CODE}`;
          authMessage.style.color = "#2A2A2A";
        } catch (error) {
          console.error(error);
          authMessage.textContent = "Error al registrar desde el popup: " + error.message;
          authMessage.style.color = "red";
        }
      });
    }

    if (registerForm) {
      registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = registerEmail.value.trim();
        const password = registerPassword.value.trim();

        try {
          await createUserWithEmailAndPassword(auth, email, password);
          localStorage.setItem('ilumae_registered', 'true');
          authMessage.textContent = `Cuenta creada. Tu c√≥digo de descuento es: ${DISCOUNT_CODE}`;
          authMessage.style.color = "#2A2A2A";
          registerForm.reset();
        } catch (error) {
          console.error(error);
          authMessage.textContent = "Error al registrarte: " + error.message;
          authMessage.style.color = "red";
        }
      });
    }

    if (loginForm) {
      loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = loginEmail.value.trim();
        const password = loginPassword.value.trim();

        try {
          await signInWithEmailAndPassword(auth, email, password);
          authMessage.textContent = "Sesi√≥n iniciada correctamente üíï";
          authMessage.style.color = "#2A2A2A";
          loginForm.reset();
        } catch (error) {
          console.error(error);
          authMessage.textContent = "Error al iniciar sesi√≥n: " + error.message;
          authMessage.style.color = "red";
        }
      });
    }

    if (logoutBtn) {
      logoutBtn.addEventListener('click', async () => {
        try {
          await signOut(auth);
          authMessage.textContent = "Sesi√≥n cerrada.";
          authMessage.style.color = "#2A2A2A";
        } catch (error) {
          console.error(error);
          authMessage.textContent = "Error al cerrar sesi√≥n: " + error.message;
          authMessage.style.color = "red";
        }
      });
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        if (userInfo && userEmailSpan && logoutBtn) {
          userInfo.style.display = "block";
          userEmailSpan.textContent = user.email;
          logoutBtn.style.display = "inline-block";
        }
      } else {
        if (userInfo && logoutBtn) {
          userInfo.style.display = "none";
          logoutBtn.style.display = "none";
        }
      }
    });

    // Cerrar modal de env√≠o
    if (closeShippingBtn && shippingOverlay) {
      closeShippingBtn.addEventListener('click', () => {
        shippingOverlay.style.display = 'none';
      });
    }

    // Guardar pedido en Firestore al enviar datos de env√≠o
    if (shippingForm) {
      shippingForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        let cartFromStorage = [];
        try {
          cartFromStorage = JSON.parse(localStorage.getItem('ilumae_cart')) || [];
        } catch (err) {
          cartFromStorage = [];
        }

        if (!cartFromStorage.length) {
          alert("Tu carrito est√° vac√≠o, vuelve a agregar productos.");
          return;
        }

        const total = cartFromStorage.reduce((s, i) => s + (i.price * i.qty), 0);

        const shippingData = {
          name: shipName.value.trim(),
          phone: shipPhone.value.trim(),
          address: shipAddress.value.trim(),
          city: shipCity.value.trim(),
          cp: shipCP.value.trim(),
          notes: shipNotes.value.trim() || null
        };

        const user = auth.currentUser;

        try {
          await addDoc(collection(db, "orders"), {
            createdAt: serverTimestamp(),
            userUid: user ? user.uid : null,
            userEmail: user ? user.email : null,
            shipping: shippingData,
            items: cartFromStorage,
            total: total,
            status: "pendiente"
          });

          localStorage.removeItem('ilumae_cart');

          alert("¬°Gracias por tu pedido! üíñ Nos pondremos en contacto para confirmar tu env√≠o.");

          if (shippingOverlay) shippingOverlay.style.display = 'none';
          window.location.reload();
        } catch (error) {
          console.error(error);
          alert("Ocurri√≥ un error al guardar tu pedido. Intenta de nuevo o escr√≠benos por WhatsApp ü´∂");
        }
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      maybeShowPopup();
    });
  </script>
</body>
</html>


